{"kics_version": "v1.6.8", "files_scanned": 1, "lines_scanned": 431, "files_parsed": 1, "lines_parsed": 431, "files_failed_to_scan": 0, "queries_total": 321, "queries_failed_to_execute": 0, "queries_failed_to_compute_similarity_id": 0, "scan_id": "console", "severity_counters": {"HIGH": 9, "INFO": 0, "LOW": 0, "MEDIUM": 0, "TRACE": 0}, "total_counter": 9, "total_bom_resources": 0, "start": "2023-02-08T15:19:01.464970628Z", "end": "2023-02-08T15:19:25.412193875Z", "paths": ["/code"], "queries": [{"query_name": "S3 Bucket ACL Allows Read Or Write to All Users", "query_id": "07dda8de-d90d-469e-9b37-1aca53526ced", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Access Control", "description": "S3 Buckets should not be readable and writable to all users", "description_id": "68456465", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "2802953cadd63d0e50d81bccb474517131e10f3a606432a3bc46aa9364ffa8c3", "line": 280, "resource_type": "AWS::S3::Bucket", "resource_name": "my-cdk-bucket", "issue_type": "IncorrectValue", "search_key": "Resources.mycdkbucketC801BBDD.AccessControl", "search_line": 0, "search_value": "", "expected_value": "S3 bucket should not have a public readable and writeble ACL", "actual_value": "S3 bucket named 'my-cdk-bucket' has ACL set to 'PublicReadWrite'"}]}, {"query_name": "S3 Bucket Allows Public Policy", "query_id": "860ba89b-b8de-4e72-af54-d6aee4138a69", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Access Control", "description": "S3 bucket allows public policy", "description_id": "bfe99abf", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "02c326dd4b5cc0420cccf0653a19ee8656b23852fc001f4d4fe159c2bc07b32b", "line": 279, "resource_type": "AWS::S3::Bucket", "resource_name": "my-cdk-bucket", "issue_type": "MissingAttribute", "search_key": "Resources.mycdkbucketC801BBDD.Properties", "search_line": 0, "search_value": "", "expected_value": "'PublicAccessBlockConfiguration' should be defined%!(EXTRA string=mycdkbucketC801BBDD)", "actual_value": "'PublicAccessBlockConfiguration' is not defined%!(EXTRA string=mycdkbucketC801BBDD)"}]}, {"query_name": "S3 Bucket SSE Disabled", "query_id": "64ab651b-f5b2-4af0-8c89-ddd03c4d0e61", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-serversideencryptionbydefault.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Encryption", "description": "If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required", "description_id": "42fd2930", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "eff51d6f2f41a172d57986fe85478982c54e62f8cdc94e971fe5c4c8881e341c", "line": 279, "resource_type": "AWS::S3::Bucket", "resource_name": "my-cdk-bucket", "issue_type": "MissingAttribute", "search_key": "Resources.mycdkbucketC801BBDD.Properties", "search_line": 0, "search_value": "", "expected_value": "Resources.mycdkbucketC801BBDD.Properties.BucketEncryption should be set", "actual_value": "Resources.mycdkbucketC801BBDD.Properties.BucketEncryption is undefined"}]}, {"query_name": "S3 Bucket Without Restriction Of Public Bucket", "query_id": "350cd468-0e2c-44ef-9d22-cfb73a62523c", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Insecure Configurations", "description": "S3 bucket without restriction of public bucket", "description_id": "f9a4d93a", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "dddeabffe2a124839c41c7f2d4501585e3c1b8b396ea4f39f4fe5493d8a90caa", "line": 279, "resource_type": "AWS::S3::Bucket", "resource_name": "my-cdk-bucket", "issue_type": "MissingAttribute", "search_key": "Resources.mycdkbucketC801BBDD.Properties", "search_line": 0, "search_value": "", "expected_value": "'PublicAccessBlockConfiguration' should be defined%!(EXTRA string=mycdkbucketC801BBDD)", "actual_value": "'PublicAccessBlockConfiguration' is not defined%!(EXTRA string=mycdkbucketC801BBDD)"}]}, {"query_name": "S3 Bucket Without SSL In Write Actions", "query_id": "38c64e76-c71e-4d92-a337-60174d1de1c9", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Encryption", "description": "S3 Buckets should enforce encryption of data transfers using Secure Sockets Layer (SSL)", "description_id": "907676d7", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "29673fed0dad9aef5e674a322d23c38ac2273ebcbbbaaaa00d4c56892def1def", "line": 277, "resource_type": "AWS::S3::Bucket", "resource_name": "my-cdk-bucket", "issue_type": "MissingAttribute", "search_key": "Resources.mycdkbucketC801BBDD", "search_line": 0, "search_value": "", "expected_value": "Resources.mycdkbucketC801BBDD bucket has a policy that enforces SSL", "actual_value": "Resources.mycdkbucketC801BBDD bucket doesn't have a policy"}]}, {"query_name": "S3 Bucket Without Server-side-encryption", "query_id": "b2e8752c-3497-4255-98d2-e4ae5b46bbf5", "query_url": "https://docs.aws.amazon.com/AmazonS3/latest/user-guide/default-bucket-encryption.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Encryption", "description": "S3 Buckets should have server-side encryption at rest enabled to protect sensitive data", "description_id": "314a460b", "cis_description_id": "CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.1", "cis_description_title": "Ensure all S3 buckets employ encryption-at-rest", "cis_description_text": "Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "ed458bdfd7d08e8e3bf7e178a9df3bbed23bd55a1b30a6d6b6f56778bbedfcba", "line": 279, "resource_type": "AWS::S3::Bucket", "resource_name": "my-cdk-bucket", "issue_type": "MissingAttribute", "search_key": "Resources.mycdkbucketC801BBDD.Properties", "search_line": 0, "search_value": "", "expected_value": "Resources.mycdkbucketC801BBDD.Properties.BucketEncryption.ServerSideEncryptionConfiguration should be defined and not empty", "actual_value": "Resources.mycdkbucketC801BBDD.Properties.BucketEncryption.ServerSideEncryptionConfiguration is undefined or empty"}]}, {"query_name": "Security Group With Unrestricted Access To SSH", "query_id": "6e856af2-62d7-4ba2-adc1-73b62cef9cc1", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Networking and Firewall", "description": "'SSH' (TCP:22) should not be public in AWS Security Group", "description_id": "d515d6dc", "cis_description_id": "CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 5.2", "cis_description_title": "Ensure no security groups allow ingress from 0.0.0.0/0 to remote server administration ports", "cis_description_text": "Security groups provide stateful filtering of ingress and egress network traffic to AWS resources. It is recommended that no security group allows unrestricted ingress access to remote server administration ports, such as SSH to port 22 and RDP to port 3389 .\nPublic access to remote server administration ports, such as 22 and 3389, increases resource attack surface and unnecessarily raises the risk of resource compromise.", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "e9fff81223ac8041e1f5c0c4352634827d6605ea3edb79ead9d30a0d58c6d1a0", "line": 305, "resource_type": "AWS::EC2::SecurityGroup", "resource_name": "sg15CEFF4E3", "issue_type": "IncorrectValue", "search_key": "Resources.sg15CEFF4E3.Properties.SecurityGroupIngress", "search_line": 0, "search_value": "", "expected_value": "None of the Resources.sg15CEFF4E3.Properties.SecurityGroupIngress has port 22", "actual_value": "One of the Resources.sg15CEFF4E3.Properties.SecurityGroupIngress has port 22"}]}, {"query_name": "Security Groups With Exposed Admin Ports", "query_id": "cdbb0467-2957-4a77-9992-7b55b29df7b7", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Networking and Firewall", "description": "Security Groups should not have ports open in (20, 21, 22, 23, 115, 137, 138, 139, 2049, 3389)", "description_id": "e14121d4", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "73b9e5bf8cf875eadc71ce59dc3854e64104fbfffb8e98f1999fa02fabf4d57c", "line": 305, "resource_type": "AWS::EC2::SecurityGroup", "resource_name": "sg15CEFF4E3", "issue_type": "IncorrectValue", "search_key": "Resources.sg15CEFF4E3.Properties.SecurityGroupIngress", "search_line": 0, "search_value": "", "expected_value": "None of the Resources.sg15CEFF4E3.Properties.SecurityGroupIngress should have an exposed port", "actual_value": "One of the Resources.sg15CEFF4E3.Properties.SecurityGroupIngress has a exposed port (20,21,22,23,115,137,138,2049,3389)"}]}, {"query_name": "Unrestricted Security Group Ingress", "query_id": "4a1e6b34-1008-4e61-a5f2-1f7c276f8d14", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-ec2-security-group-ingress.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Networking and Firewall", "description": "AWS Security Group Ingress CIDR should not be open to the world", "description_id": "08256d31", "cis_description_id": "CIS Security -  v - Rule ", "cis_description_text": "Security groups should restrict ingress only to well-known and allowed origins: IP addresses or ranges. Unrestricted access may expose security groups associated resources to the Internet, allowing, for example, access to remote server open ports.\nPublic access to remote servers increases the resource attack surface and unnecessarily raises the risk of resource compromise.", "files": [{"file_name": "cfn-stack.yaml", "similarity_id": "b3b3b0460766e78aeb245307346c74914917e7e5f45b61f201de0774b7ca3d7d", "line": 305, "resource_type": "AWS::EC2::SecurityGroup", "resource_name": "sg15CEFF4E3", "issue_type": "IncorrectValue", "search_key": "Resources.sg15CEFF4E3.Properties.SecurityGroupIngress", "search_line": 0, "search_value": "", "expected_value": "Resources.sg15CEFF4E3.Properties.SecurityGroupIngress[0].CidrIp should not be open to the world (0.0.0.0/0)", "actual_value": "Resources.sg15CEFF4E3.Properties.SecurityGroupIngress[0].CidrIp is open to the world (0.0.0.0/0)"}]}]}
