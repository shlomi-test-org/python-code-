{"kics_version": "v1.6.8", "files_scanned": 1, "lines_scanned": 26, "files_parsed": 1, "lines_parsed": 26, "files_failed_to_scan": 0, "queries_total": 326, "queries_failed_to_execute": 0, "queries_failed_to_compute_similarity_id": 0, "scan_id": "console", "severity_counters": {"HIGH": 10, "INFO": 0, "LOW": 0, "MEDIUM": 0, "TRACE": 0}, "total_counter": 10, "total_bom_resources": 0, "start": "2023-02-08T15:18:29.609565918Z", "end": "2023-02-08T15:18:53.88221993Z", "paths": ["/code"], "queries": [{"query_name": "S3 Bucket Allows Public Policy", "query_id": "860ba89b-b8de-4e72-af54-d6aee4138a69", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Access Control", "description": "S3 bucket allows public policy", "description_id": "bfe99abf", "files": [{"file_name": "s3_bucket.yml", "similarity_id": "1a5d01ed34bdaa106938d38c03726f9f6f46e4fb9707538a474a78fb8cd8d61c", "line": 15, "resource_type": "AWS::S3::Bucket", "resource_name": "BucketName", "issue_type": "MissingAttribute", "search_key": "Resources.MainBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "'PublicAccessBlockConfiguration' should be defined%!(EXTRA string=MainBucket)", "actual_value": "'PublicAccessBlockConfiguration' is not defined%!(EXTRA string=MainBucket)"}, {"file_name": "s3_bucket.yml", "similarity_id": "7b4ff9445d33071a37e0f53c67a16292e70c7790c578a25a75f8c4c7505d4478", "line": 10, "resource_type": "AWS::S3::Bucket", "resource_name": "AccessLogBucket", "issue_type": "MissingAttribute", "search_key": "Resources.AccessLogBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "'PublicAccessBlockConfiguration' should be defined%!(EXTRA string=AccessLogBucket)", "actual_value": "'PublicAccessBlockConfiguration' is not defined%!(EXTRA string=AccessLogBucket)"}]}, {"query_name": "S3 Bucket SSE Disabled", "query_id": "64ab651b-f5b2-4af0-8c89-ddd03c4d0e61", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-serversideencryptionbydefault.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Encryption", "description": "If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required", "description_id": "42fd2930", "files": [{"file_name": "s3_bucket.yml", "similarity_id": "02db2d7580473baa583d6781669187bb718009992df7ba87e7631116ecf0df63", "line": 10, "resource_type": "AWS::S3::Bucket", "resource_name": "AccessLogBucket", "issue_type": "MissingAttribute", "search_key": "Resources.AccessLogBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "Resources.AccessLogBucket.Properties.BucketEncryption should be set", "actual_value": "Resources.AccessLogBucket.Properties.BucketEncryption is undefined"}, {"file_name": "s3_bucket.yml", "similarity_id": "875de2799013d02a5a54505a866e7fc7b8db9bde6f5a001dfdc871884eb8e513", "line": 15, "resource_type": "AWS::S3::Bucket", "resource_name": "BucketName", "issue_type": "MissingAttribute", "search_key": "Resources.MainBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "Resources.MainBucket.Properties.BucketEncryption should be set", "actual_value": "Resources.MainBucket.Properties.BucketEncryption is undefined"}]}, {"query_name": "S3 Bucket Without Restriction Of Public Bucket", "query_id": "350cd468-0e2c-44ef-9d22-cfb73a62523c", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket-publicaccessblockconfiguration.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Insecure Configurations", "description": "S3 bucket without restriction of public bucket", "description_id": "f9a4d93a", "files": [{"file_name": "s3_bucket.yml", "similarity_id": "bcf75bc2b1d0fa306ecbbb562c9ea7f923775f405e2b37094280dc5828ffed51", "line": 10, "resource_type": "AWS::S3::Bucket", "resource_name": "AccessLogBucket", "issue_type": "MissingAttribute", "search_key": "Resources.AccessLogBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "'PublicAccessBlockConfiguration' should be defined%!(EXTRA string=AccessLogBucket)", "actual_value": "'PublicAccessBlockConfiguration' is not defined%!(EXTRA string=AccessLogBucket)"}, {"file_name": "s3_bucket.yml", "similarity_id": "c9c5945c3c54b0596255a03b6003953e215d069e240a621ef528435f9a8e4078", "line": 15, "resource_type": "AWS::S3::Bucket", "resource_name": "BucketName", "issue_type": "MissingAttribute", "search_key": "Resources.MainBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "'PublicAccessBlockConfiguration' should be defined%!(EXTRA string=MainBucket)", "actual_value": "'PublicAccessBlockConfiguration' is not defined%!(EXTRA string=MainBucket)"}]}, {"query_name": "S3 Bucket Without SSL In Write Actions", "query_id": "38c64e76-c71e-4d92-a337-60174d1de1c9", "query_url": "https://docs.aws.amazon.com/AWSCloudFormation/latest/UserGuide/aws-properties-s3-bucket.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Encryption", "description": "S3 Buckets should enforce encryption of data transfers using Secure Sockets Layer (SSL)", "description_id": "907676d7", "files": [{"file_name": "s3_bucket.yml", "similarity_id": "dfa6c9bd8528b8b64f3c1a1d99fdbd04acf47f4df63e072b41f2c94a1c78e8f5", "line": 8, "resource_type": "AWS::S3::Bucket", "resource_name": "AccessLogBucket", "issue_type": "MissingAttribute", "search_key": "Resources.AccessLogBucket", "search_line": 0, "search_value": "", "expected_value": "Resources.AccessLogBucket bucket has a policy that enforces SSL", "actual_value": "Resources.AccessLogBucket bucket doesn't have a policy"}, {"file_name": "s3_bucket.yml", "similarity_id": "b8e1dab6055d3c18b0ad0a737e160473a770a7be4a8567f1c47e6f07bd603ace", "line": 13, "resource_type": "AWS::S3::Bucket", "resource_name": "BucketName", "issue_type": "MissingAttribute", "search_key": "Resources.MainBucket", "search_line": 0, "search_value": "", "expected_value": "Resources.MainBucket bucket has a policy that enforces SSL", "actual_value": "Resources.MainBucket bucket doesn't have a policy"}]}, {"query_name": "S3 Bucket Without Server-side-encryption", "query_id": "b2e8752c-3497-4255-98d2-e4ae5b46bbf5", "query_url": "https://docs.aws.amazon.com/AmazonS3/latest/user-guide/default-bucket-encryption.html", "severity": "HIGH", "platform": "CloudFormation", "cloud_provider": "AWS", "category": "Encryption", "description": "S3 Buckets should have server-side encryption at rest enabled to protect sensitive data", "description_id": "314a460b", "cis_description_id": "CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.1", "cis_description_title": "Ensure all S3 buckets employ encryption-at-rest", "cis_description_text": "Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.", "files": [{"file_name": "s3_bucket.yml", "similarity_id": "27c8569166637cf536253b69a6703886de38a9a736851a0c03908a5341185dd0", "line": 10, "resource_type": "AWS::S3::Bucket", "resource_name": "AccessLogBucket", "issue_type": "MissingAttribute", "search_key": "Resources.AccessLogBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "Resources.AccessLogBucket.Properties.BucketEncryption.ServerSideEncryptionConfiguration should be defined and not empty", "actual_value": "Resources.AccessLogBucket.Properties.BucketEncryption.ServerSideEncryptionConfiguration is undefined or empty"}, {"file_name": "s3_bucket.yml", "similarity_id": "c6b74cf6c3ab1f068e99e217de847101d350cbe8c863740d27e3c51f9e8b4754", "line": 15, "resource_type": "AWS::S3::Bucket", "resource_name": "BucketName", "issue_type": "MissingAttribute", "search_key": "Resources.MainBucket.Properties", "search_line": 0, "search_value": "", "expected_value": "Resources.MainBucket.Properties.BucketEncryption.ServerSideEncryptionConfiguration should be defined and not empty", "actual_value": "Resources.MainBucket.Properties.BucketEncryption.ServerSideEncryptionConfiguration is undefined or empty"}]}]}
