{"kics_version": "v1.6.8", "files_scanned": 1, "lines_scanned": 176, "files_parsed": 1, "lines_parsed": 176, "files_failed_to_scan": 0, "queries_total": 387, "queries_failed_to_execute": 0, "queries_failed_to_compute_similarity_id": 0, "scan_id": "console", "severity_counters": {"HIGH": 15, "INFO": 0, "LOW": 0, "MEDIUM": 0, "TRACE": 0}, "total_counter": 15, "total_bom_resources": 0, "start": "2023-02-08T15:16:33.159602878Z", "end": "2023-02-08T15:17:37.569167214Z", "paths": ["/code"], "queries": [{"query_name": "S3 Bucket ACL Allows Read Or Write to All Users", "query_id": "38c5ee0d-7f22-4260-ab72-5073048df100", "query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket", "severity": "HIGH", "platform": "Terraform", "cloud_provider": "AWS", "category": "Access Control", "description": "S3 Buckets should not be readable and writable to all users", "description_id": "d535387f", "files": [{"file_name": "sample_file.tf", "similarity_id": "8b753adbf945ff4f9f22d7ad9a75ce8613748f9543aff15c4f56751bdd2a453d", "line": 7, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-data", "issue_type": "IncorrectValue", "search_key": "aws_s3_bucket[data].acl=public-read", "search_line": 0, "search_value": "", "expected_value": "'acl' should equal to 'private'", "actual_value": "'acl' is equal 'public-read'"}]}, {"query_name": "S3 Bucket Allows Public Policy", "query_id": "1a4bc881-9f69-4d44-8c9a-d37d08f54c50", "query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block", "severity": "HIGH", "platform": "Terraform", "cloud_provider": "AWS", "category": "Access Control", "description": "S3 bucket allows public policy", "description_id": "a8924b3b", "files": [{"file_name": "sample_file.tf", "similarity_id": "419ad45136e8e643ab2c05ec8d335064a5a17d5f481ae7a08cf5b61714a6b329", "line": 145, "resource_type": "n/a", "resource_name": "n/a", "issue_type": "MissingAttribute", "search_key": "module[s3_bucket]", "search_line": 0, "search_value": "", "expected_value": "'block_public_policy' should equal 'true'", "actual_value": "'block_public_policy' is missing"}]}, {"query_name": "S3 Bucket Object Not Encrypted", "query_id": "5fb49a69-8d46-4495-a2f8-9c8c622b2b6e", "query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_object#server_side_encryption", "severity": "HIGH", "platform": "Terraform", "cloud_provider": "AWS", "category": "Encryption", "description": "S3 Bucket Object should have server-side encryption enabled", "description_id": "e6b92744", "cis_description_id": "CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.1", "cis_description_title": "Ensure all S3 buckets employ encryption-at-rest", "cis_description_text": "Amazon S3 provides a variety of no, or low, cost encryption options to protect data at rest.\nEncrypting data at rest reduces the likelihood that it is unintentionally exposed and can nullify the impact of disclosure if the encryption remains unbroken.", "files": [{"file_name": "sample_file.tf", "similarity_id": "cf4ef83463b6cbee2b6ee48d9e395aa6f760f5f4bcc38e2759f6d97111359cc6", "line": 24, "resource_type": "aws_s3_bucket_object", "resource_name": "${aws_s3_bucket.data.id}", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket_object[{{data_object}}]", "search_line": 0, "search_value": "", "expected_value": "aws_s3_bucket_object.server_side_encryption should be defined and not null", "actual_value": "aws_s3_bucket_object.server_side_encryption is undefined or null"}]}, {"query_name": "S3 Bucket SSE Disabled", "query_id": "6726dcc0-5ff5-459d-b473-a780bef7665c", "query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#server_side_encryption_configuration", "severity": "HIGH", "platform": "Terraform", "cloud_provider": "AWS", "category": "Encryption", "description": "If algorithm is AES256 then the master key is null, empty or undefined, otherwise the master key is required", "description_id": "b386c506", "files": [{"file_name": "sample_file.tf", "similarity_id": "0a69b20ac0cb00008f4b623b89996529739272c3b133ea8aec4f570a2c340f58", "line": 1, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-data", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[data]", "search_line": 0, "search_value": "", "expected_value": "'aws_s3_bucket' to have 'server_side_encryption_configuration' associated", "actual_value": "'aws_s3_bucket' does not have 'server_side_encryption_configuration' associated"}, {"file_name": "sample_file.tf", "similarity_id": "f50c9782d163595ab137a76769a52ec342d205bf0a5d59ddb1bce94fb7083f4f", "line": 66, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-operations", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[operations]", "search_line": 0, "search_value": "", "expected_value": "'aws_s3_bucket' to have 'server_side_encryption_configuration' associated", "actual_value": "'aws_s3_bucket' does not have 'server_side_encryption_configuration' associated"}, {"file_name": "sample_file.tf", "similarity_id": "a9e9566ac894730604882e310d39ce19b6f16de5dcc764495a0898ab76a5029c", "line": 91, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-data-science", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[data_science]", "search_line": 0, "search_value": "", "expected_value": "'aws_s3_bucket' to have 'server_side_encryption_configuration' associated", "actual_value": "'aws_s3_bucket' does not have 'server_side_encryption_configuration' associated"}, {"file_name": "sample_file.tf", "similarity_id": "a4eaad956d5886972f7def1de303f4e0e7c95ceb6c3941d98e12245f3e012157", "line": 145, "resource_type": "n/a", "resource_name": "n/a", "issue_type": "MissingAttribute", "search_key": "module[s3_bucket]", "search_line": 0, "search_value": "", "expected_value": "'server_side_encryption_configuration' should be defined and not null", "actual_value": "'server_side_encryption_configuration' is undefined or null"}, {"file_name": "sample_file.tf", "similarity_id": "ee6f1fe3ce5df76f4cc08a4107bd9a8a7135519665a298ea9415be83e81465f8", "line": 43, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-financials", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[financials]", "search_line": 0, "search_value": "", "expected_value": "'aws_s3_bucket' to have 'server_side_encryption_configuration' associated", "actual_value": "'aws_s3_bucket' does not have 'server_side_encryption_configuration' associated"}]}, {"query_name": "S3 Bucket Without Enabled MFA Delete", "query_id": "c5b31ab9-0f26-4a49-b8aa-4cc064392f4d", "query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket#mfa_delete", "severity": "HIGH", "platform": "Terraform", "cloud_provider": "AWS", "category": "Insecure Configurations", "description": "S3 bucket without MFA Delete Enabled. MFA delete cannot be enabled through Terraform, it can be done by adding a MFA device (https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_mfa_enable.html) and enabling versioning and MFA delete by using AWS CLI: 'aws s3api put-bucket-versioning --versioning-configuration=Status=Enabled,MFADelete=Enabled --bucket=<BUCKET_NAME> --mfa=<MFA_SERIAL_NUMBER>'. Please, also notice that MFA delete can not be used with lifecycle configurations", "description_id": "e1699d08", "cis_description_id": "CIS Security - CIS Amazon Web Services Foundations Benchmark v1.4.0 - Rule 2.1.3", "cis_description_title": "Ensure MFA Delete is enable on S3 buckets", "cis_description_text": "Once MFA Delete is enabled on your sensitive and classified S3 bucket it requires the user to have two forms of authentication.\nAdding MFA delete to an S3 bucket, requires additional authentication when you change the version state of your bucket or you delete and object version adding another layer of security in the event your security credentials are compromised or unauthorized access is granted.", "files": [{"file_name": "sample_file.tf", "similarity_id": "1e4e38ed2cf864da25ef3f5674bef42a6864d15aac8aef00869cc7eaf3e8ff48", "line": 154, "resource_type": "n/a", "resource_name": "n/a", "issue_type": "MissingAttribute", "search_key": "module[s3_bucket].versioning", "search_line": 0, "search_value": "", "expected_value": "'mfa_delete' should be set to true", "actual_value": "'mfa_delete' is undefined or null"}, {"file_name": "sample_file.tf", "similarity_id": "0df4a07db778be721c93a59f3513ebce865edf9cc73b964806ee541a07532e1d", "line": 43, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-financials", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[financials]", "search_line": 0, "search_value": "", "expected_value": "versioning should be defined and not null", "actual_value": "versioning is undefined or null"}, {"file_name": "sample_file.tf", "similarity_id": "eda49958fa381d765b9792b730a56760bf52b1b43d30ad395417922401e51081", "line": 95, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-data-science", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[data_science].versioning", "search_line": 0, "search_value": "", "expected_value": "'mfa_delete' should be set to true", "actual_value": "'mfa_delete' is undefined or null"}, {"file_name": "sample_file.tf", "similarity_id": "5011e87a5e9d3027cfb1ed4464c8f144932360322217af9f100f1cba10458e98", "line": 118, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-logs", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[logs].versioning", "search_line": 0, "search_value": "", "expected_value": "'mfa_delete' should be set to true", "actual_value": "'mfa_delete' is undefined or null"}, {"file_name": "sample_file.tf", "similarity_id": "d6c6834a8a565770793ba5c1658e272f43d048d98b2bbb203f5c44b4b6717bbd", "line": 71, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-operations", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[operations].versioning", "search_line": 0, "search_value": "", "expected_value": "'mfa_delete' should be set to true", "actual_value": "'mfa_delete' is undefined or null"}, {"file_name": "sample_file.tf", "similarity_id": "105a584c32231107ffce9ab8f17930d7a10f1d74207b244a43bba4decbc287d1", "line": 1, "resource_type": "aws_s3_bucket", "resource_name": "local.resource_prefix.value-data", "issue_type": "MissingAttribute", "search_key": "aws_s3_bucket[data]", "search_line": 0, "search_value": "", "expected_value": "versioning should be defined and not null", "actual_value": "versioning is undefined or null"}]}, {"query_name": "S3 Bucket Without Restriction Of Public Bucket", "query_id": "1ec253ab-c220-4d63-b2de-5b40e0af9293", "query_url": "https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/s3_bucket_public_access_block", "severity": "HIGH", "platform": "Terraform", "cloud_provider": "AWS", "category": "Insecure Configurations", "description": "S3 bucket without restriction of public bucket", "description_id": "a6e86c32", "files": [{"file_name": "sample_file.tf", "similarity_id": "ed70d8da8e094f2ed72d57395480aa28d946ef7993a919fe350e9e8fc0ea5f31", "line": 152, "resource_type": "n/a", "resource_name": "n/a", "issue_type": "IncorrectValue", "search_key": "module[s3_bucket].restrict_public_buckets", "search_line": 0, "search_value": "", "expected_value": "'restrict_public_buckets' should equal 'true'", "actual_value": "'restrict_public_buckets' is equal 'false'", "remediation": "{\"after\":\"true\",\"before\":\"false\"}", "remediation_type": "replacement", "fix_suggestion": {"start_line": 152, "end_line": 152, "guidelines": "**Issue Type**: IncorrectValue\n**Expected value**: 'restrict_public_buckets' should equal 'true'\n**Actual value**: 'restrict_public_buckets' is equal 'false'", "title": "S3 Bucket Without Restriction Of Public Bucket", "reason": "Insecure Configurations - S3 bucket without restriction of public bucket. ", "filename": "sample_file.tf", "current_text": "  restrict_public_buckets = false", "new_text": "  restrict_public_buckets = true", "is_auto_generated": true}}]}]}
